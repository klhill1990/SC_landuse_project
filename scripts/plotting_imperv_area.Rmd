---
title: "impervious_area_lm_plots"
output: html_notebook
---

```{r}
library(dplyr)
library(tidyr)
```

```{r}
#import data

scecap_watershed <- read.csv("./data/watershed_env_data.csv")
impervious <- read.csv("./data/impervious_prct_cover.csv")

#subset impervious data (most recent year, upland cat = 2) 

impervious_subset <- filter(impervious, YEAR == 2011, UPLAND == 2)

#join environmental data with impervious cover

scecap_imperv_join <- full_join(scecap_watershed, impervious_subset, by = "HUC_ID")

#remove HUCs w/ less than 3 stations

scecap_imperv_join <- filter(scecap_imperv_join, NUMBER_STATIONS >2)

#separate data by HUC digit

scecap_imperv_huc08 <- filter(scecap_imperv_join, HUC_DIGITS.x == 8)
scecap_imperv_huc10 <- filter(scecap_imperv_join, HUC_DIGITS.x == 10)
scecap_imperv_huc12 <- filter(scecap_imperv_join, HUC_DIGITS.x == 12)
scecap_imperv_huc14 <- filter(scecap_imperv_join, HUC_DIGITS.x == 14)
```

```{r}
#build function that plots linear model between impervious cover (x) and environmental response (y)

scecap_scatterplot <- function(x) 
  
  {
  for(i in 5:10)  
    {
    lm_xy <- lm((x[,i]) ~ (x[,14]))
    lm_xy_sum <- summary(lm_xy)
    rsqr <- lm_xy_sum$adj.r.squared
    plot((x[,i]) ~ (x[,14]), main = paste("HUC", x[1,3]), xlab = colnames(x[14]), ylab = colnames(x[i]))
    abline(lm_xy, col = 'red')
    legend("topright", bty="n", legend=paste("Adj.R2 =", format(rsqr, digits=4)))
    }
  }

#run function for each watershed category
scecap_scatterplot(scecap_imperv_huc08)
scecap_scatterplot(scecap_imperv_huc10)
scecap_scatterplot(scecap_imperv_huc12)
scecap_scatterplot(scecap_imperv_huc14)
```

