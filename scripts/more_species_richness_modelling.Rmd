---
title: "more_species_richness_modeling"
output: html_notebook
---
```{r}
library(tidyverse)
library(OneR)

#import datasets
imperv_data <- read.csv("./data/impervious_prct_cover.csv")
scecap_data <- read.csv("./data/SCECAP_data.csv")
trawl_spp <- read.csv("./data/trawl_species_data.csv")

#use dplyr to group summarize data to get species richness for each station

trawl_richness <- trawl_spp %>% group_by(STATION_ID) %>% summarize(n_distinct(SP_CODE)) 

#rename columns

names(trawl_richness) <- c("STATION_ID","SP_RICHNESS")

#subset impervious data for HUC14s, upland category, and most recent data

HUC14_data <- filter(imperv_data, HUC_DIGITS == 14, YEAR == 2011, UPLAND ==2)


#create bins for impervious area and insert into new colum

HUC14_data$DEV_CAT <- bin(HUC14_data$PRCT_IMPERV, nbins = 3 , labels = c("Low Development", "Moderate Development", "High Development"), method = "clusters", na.omit = TRUE)
#select columns to use, and rename 
HUC14 <- select(HUC14_data, HUC_ID, PRCT_IMPERV, DEV_CAT)
names(HUC14) <- c("HUC_14", "PRCT_IMP", "DEV_CAT")
scecap_station <- select(scecap_data, STATION_ID, HUC_14)

#join species richness, station, and watershed datasets into one
trawl_station <- full_join(trawl_richness, scecap_station, by = "STATION_ID")
huc14_sp_rich <- full_join(trawl_station, HUC14, by = "HUC_14")

#create boxplot showing development categories with species richness

sp_rich_landdev <- ggplot(data = huc14_sp_rich, aes(x=DEV_CAT, y=SP_RICHNESS)) + 
  geom_boxplot() + 
  theme_minimal() + 
  labs(y="Species Richness", x="Development Category")

sp_rich_landdev

#repeat but with other HUC categories
HUC14_data <- filter(imperv_data, HUC_DIGITS == 14, YEAR == 2011, UPLAND ==2)
HUC12_data <- filter(imperv_data, HUC_DIGITS == 12, YEAR == 2011, UPLAND ==2)
HUC10_data <- filter(imperv_data, HUC_DIGITS == 10, YEAR == 2011, UPLAND ==2)
HUC08_data <- filter(imperv_data, HUC_DIGITS == 8 , YEAR == 2011, UPLAND ==2)


#create bins for impervious area and insert into new colum
HUC14_data$DEV_CAT <- bin(HUC14_data$PRCT_IMPERV, nbins = 3 , labels = c("Low Development", "Moderate Development", "High Development"), method = "clusters", na.omit = TRUE)

HUC12_data$DEV_CAT <- bin(HUC12_data$PRCT_IMPERV, nbins = 3 , labels = c("Low Development", "Moderate Development", "High Development"), method = "clusters", na.omit = TRUE)

HUC10_data$DEV_CAT <- bin(HUC10_data$PRCT_IMPERV, nbins = 3 , labels = c("Low Development", "Moderate Development", "High Development"), method = "clusters", na.omit = TRUE)

HUC08_data$DEV_CAT <- bin(HUC08_data$PRCT_IMPERV, nbins = 3 , labels = c("Low Development", "Moderate Development", "High Development"), method = "clusters", na.omit = TRUE)

#select columns to use, and rename 
HUC14 <- select(HUC14_data, HUC_ID, PRCT_IMPERV, DEV_CAT)
names(HUC14) <- c("HUC_14", "PRCT_IMP", "DEV_CAT")
HUC12 <- select(HUC12_data, HUC_ID, PRCT_IMPERV, DEV_CAT)
names(HUC12) <- c("HUC_12", "PRCT_IMP", "DEV_CAT")
HUC10 <- select(HUC10_data, HUC_ID, PRCT_IMPERV, DEV_CAT)
names(HUC10) <- c("HUC_10", "PRCT_IMP", "DEV_CAT")
HUC08 <- select(HUC08_data, HUC_ID, PRCT_IMPERV, DEV_CAT)
names(HUC08) <- c("HUC_08", "PRCT_IMP", "DEV_CAT")

scecap_station14 <- select(scecap_data, STATION_ID, HUC_14)
scecap_station12 <- select(scecap_data, STATION_ID, HUC_12)
scecap_station10 <- select(scecap_data, STATION_ID, HUC_10)
scecap_station08 <- select(scecap_data, STATION_ID, HUC_08)

#join species richness, station, and watershed datasets into one
trawl_station14 <- full_join(trawl_richness, scecap_station14, by = "STATION_ID")
trawl_station12 <- full_join(trawl_richness, scecap_station12, by = "STATION_ID")
trawl_station10 <- full_join(trawl_richness, scecap_station10, by = "STATION_ID")
trawl_station08 <- full_join(trawl_richness, scecap_station08, by = "STATION_ID")

huc14_sp_rich <- full_join(trawl_station14, HUC14, by = "HUC_14")
huc12_sp_rich <- full_join(trawl_station12, HUC12, by = "HUC_12")
huc10_sp_rich <- full_join(trawl_station10, HUC10, by = "HUC_10")
huc08_sp_rich <- full_join(trawl_station08, HUC08, by = "HUC_08")


#create boxplot showing development categories with species richness

sp_rich_landdev14 <- ggplot(data = na.omit(huc14_sp_rich), aes(x=DEV_CAT, y=SP_RICHNESS)) + 
  geom_boxplot() + 
  theme_minimal() + 
  labs(y="Species Richness", x="HUC14 Development Category")

sp_rich_landdev12 <- ggplot(data = na.omit(huc12_sp_rich), aes(x=DEV_CAT, y=SP_RICHNESS)) + 
  geom_boxplot() + 
  theme_minimal() + 
  labs(y="Species Richness", x="HUC12 Development Category")

sp_rich_landdev10 <- ggplot(data = na.omit(huc10_sp_rich), aes(x=DEV_CAT, y=SP_RICHNESS)) + 
  geom_boxplot() + 
  theme_minimal() + 
  labs(y="Species Richness", x="HUC10 Development Category")

sp_rich_landdev08 <- ggplot(data = na.omit(huc08_sp_rich), aes(x=DEV_CAT, y=SP_RICHNESS)) + 
  geom_boxplot() + 
  theme_minimal() + 
  labs(y="Species Richness", x="HUC08 Development Category")

sp_rich_landdev14
sp_rich_landdev12
sp_rich_landdev10
sp_rich_landdev08
```
